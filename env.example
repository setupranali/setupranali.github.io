# =============================================================================
# SetuPranali - Environment Configuration
# =============================================================================
# Copy this file to .env and configure for your environment.
#
# SECURITY WARNING:
# - Never commit .env to version control
# - Use secrets manager in production (AWS Secrets Manager, Vault, etc.)
# - Rotate keys periodically
#
# Generate encryption key:
#   python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# =============================================================================


# -----------------------------------------------------------------------------
# REQUIRED: Security
# -----------------------------------------------------------------------------

# Fernet encryption key for source credentials (REQUIRED)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# WARNING: If you change this, all existing encrypted credentials become unreadable!
UBI_SECRET_KEY=your-32-byte-base64-encoded-fernet-key-here


# -----------------------------------------------------------------------------
# REQUIRED: Redis
# -----------------------------------------------------------------------------

# Redis connection URL for caching and rate limiting
# Format: redis://[password@]host:port/db
# Examples:
#   - Local: redis://localhost:6379/0
#   - Docker: redis://redis:6379/0
#   - Auth: redis://:mypassword@redis.example.com:6379/0
#   - TLS: rediss://:password@redis.example.com:6380/0
REDIS_URL=redis://localhost:6379/0


# -----------------------------------------------------------------------------
# Cache Configuration
# -----------------------------------------------------------------------------

# Enable/disable query caching (true/false)
# Disabling caching increases database load but ensures fresh data
CACHE_ENABLED=true

# Cache TTL in seconds (default: 60)
# Longer TTL = better performance, but staler data
CACHE_TTL_SECONDS=60

# Skip caching results larger than this many rows
# Large results consume Redis memory; set based on your Redis capacity
CACHE_MAX_ROWS=10000

# Cache results from admin bypass queries (default: false)
# Set to true only if admins need cached results
CACHE_ADMIN_BYPASS=false


# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------

# Enable/disable rate limiting (true/false)
# Disable only for trusted internal deployments
RATE_LIMIT_ENABLED=true

# Query endpoint rate limit (format: requests/period)
# Period can be: second, minute, hour, day
RATE_LIMIT_QUERY=60/minute

# OData endpoint rate limit (typically higher for metadata requests)
RATE_LIMIT_ODATA=120/minute

# Sources endpoint rate limit (admin operations, lower limit)
RATE_LIMIT_SOURCES=30/minute


# -----------------------------------------------------------------------------
# Safety Guards
# -----------------------------------------------------------------------------

# Enable/disable query safety guards (true/false)
# Guards protect against runaway queries; disable only for debugging
SAFETY_GUARDS_ENABLED=true

# Maximum rows per query (default: 100000)
# Prevents memory exhaustion from large result sets
QUERY_MAX_ROWS=100000

# Maximum dimensions per query (default: 20)
# Prevents wide result sets
QUERY_MAX_DIMENSIONS=20

# Maximum metrics per query (default: 50)
# Prevents complex aggregations
QUERY_MAX_METRICS=50

# Maximum filter nesting depth (default: 10)
# Prevents DoS via deeply nested filters
QUERY_MAX_FILTER_DEPTH=10

# Query execution timeout in seconds (default: 30)
# Prevents long-running queries from blocking resources
QUERY_TIMEOUT_SECONDS=30


# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------

# API port (default: 8080)
API_PORT=8080

# Environment (development/staging/production)
# Affects logging verbosity and default behaviors
ENV=development

# Log level (DEBUG/INFO/WARNING/ERROR)
LOG_LEVEL=INFO


# -----------------------------------------------------------------------------
# Database (Optional)
# -----------------------------------------------------------------------------
# These are only needed if connecting to external PostgreSQL sources.
# DuckDB runs in-memory and doesn't need configuration.

# Example PostgreSQL connection (configured per-source via API)
# POSTGRES_HOST=localhost
# POSTGRES_PORT=5432
# POSTGRES_DB=analytics
# POSTGRES_USER=readonly
# POSTGRES_PASSWORD=secret

